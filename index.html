<!DOCTYPE html>
<html lang="es" class="h-full bg-gray-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Informes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 
      Librerías para .docx
      Usamos la URL 8.5.0 que proporcionaste.
    -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* --- Estilos para la Impresión (PDF) --- */
        @media print {
            /* Ocultar el formulario y los botones al imprimir */
            #form-section, #controls-section {
                display: none !important;
            }

            /* Asegurarse de que la vista previa ocupe todo el espacio */
            #output-section {
                display: block !important;
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
                border: none !important;
            }

            /* Evitar que el contenedor principal sea demasiado estrecho */
            main {
                max-width: 100% !important;
                padding: 0 !important;
            }

            /* Corrección para la página en blanco: permitir que el contenido se divida */
            .activity-output-entry {
                 /* page-break-inside: avoid; <-- Eliminamos esto para evitar la página en blanco */
            }

            /* Ocultar los botones de eliminar en la impresión */
            .delete-activity-btn {
                display: none !importnant;
            }

            /* Forzar fondos blancos y quitar bordes en la impresión */
            .bg-gray-50, .border {
                background-color: transparent !important;
                border: none !important;
            }

            /* Asegurar que los enlaces se vean */
            a {
                color: #000 !important;
                text-decoration: underline !important;
            }
        }
    </style>
</head>
<body class="h-full flex items-start justify-center py-8 md:py-12 px-4">

    <main class="w-full max-w-4xl mx-auto space-y-8">
        
        <!-- 1. Sección del Formulario -->
        <div id="form-section" class="bg-white p-6 md:p-8 rounded-lg shadow-md">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6">Generador de Informes de Proyecto</h1>
            
            <div class="space-y-6">
                <!-- Logo de Cabecera (RESTAURADO) -->
                <div>
                    <label for="logo-file" class="block text-xl font-medium text-gray-800 mb-2">Logo de Cabecera (Opcional)</label>
                    <input type="file" id="logo-file" class="w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 cursor-pointer" accept="image/*">
                </div>
                
                <!-- Título General del Proyecto -->
                <div>
                    <label for="project-title" class="block text-xl font-medium text-gray-800 mb-2">Título del Proyecto</label>
                    <input type="text" id="project-title" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" placeholder="Ej: Resumen de Actividades Q3">
                </div>

                <!-- Contenedor de Actividades Dinámicas -->
                <div>
                    <h2 class="text-xl font-medium text-gray-800 mb-4">Actividades del Proyecto</h2>
                    <div id="activities-container" class="space-y-6">
                        <!-- Las actividades se insertarán aquí por JS -->
                    </div>
                    <button id="add-activity-btn" class="mt-6 w-full flex justify-center items-center py-3 px-6 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        + Añadir Nueva Actividad
                    </button>
                </div>
            </div>
        </div>

        <!-- 2. Sección de Controles de Generación -->
        <div id="controls-section" class="bg-white p-6 rounded-lg shadow-md flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4">
            <div class="flex items-center space-x-3">
                <button id="generate-btn" class="w-full md:w-auto py-3 px-6 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-gray-400">
                    Generar Documento
                </button>
                <span id="lib-status" class="text-sm text-gray-500">Cargando librerías...</span>
            </div>
            
            <div class="flex items-center space-x-4">
                <button id="print-btn" class="w-full md:w-auto py-3 px-5 border border-gray-300 rounded-md shadow-sm text-base font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 hidden">
                    Imprimir (Guardar como PDF)
                </button>
                <button id="docx-btn" class="w-full md:w-auto py-3 px-5 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 hidden disabled:bg-gray-400" disabled>
                    Descargar .docx
                </button>
            </div>
        </div>

        <!-- 3. Sección de Vista Previa (inicialmente oculta) -->
        <div id="output-section" class="hidden bg-white p-8 md:p-12 rounded-lg shadow-lg relative print:shadow-none print:p-0">
            <style id="print-styles"></style>
            <div id="document-output" class="prose prose-lg max-w-none">
                <!-- El contenido generado se insertará aquí -->
            </div>
        </div>

    </main>


    <!-- Plantilla para una nueva actividad (para clonar) -->
    <template id="activity-template">
        <div class="activity-entry border border-gray-300 p-5 rounded-lg bg-gray-50 relative">
            <button class="delete-activity-btn absolute top-3 right-3 text-gray-400 hover:text-red-600" title="Eliminar esta actividad">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
            </button>
            <div class="space-y-4">
                <div>
                    <label class="block text-base font-medium text-gray-700">Nombre de la Actividad</label>
                    <input type="text" class="activity-name mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm" placeholder="Ej: Plantación en el IES...">
                </div>
                <div>
                    <label class="block text-base font-medium text-gray-700">Fecha de la Actividad</label>
                    <input type="date" class="activity-date mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">
                </div>
                
                <!-- *** MODIFICADO: Campo de subida y campo de URL *** -->
                <div class="bg-white p-4 rounded-md border">
                    <label class="block text-base font-medium text-gray-700">1. Subir Foto(s) desde el ordenador</label>
                    <input type="file" class="activity-image mt-1 block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100" accept="image/*" multiple>
                    
                    <label class="block text-base font-medium text-gray-700 mt-4">2. O pegar URLs de imágenes (una por línea)</label>
                    <textarea class="activity-image-urls mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm" rows="3" placeholder="https://ejemplo.com/foto1.jpg&#10;https://ejemplo.com/foto2.png"></textarea>
                </div>
                
                <div class="bg-white p-4 rounded-md border">
                    <label class="block text-base font-medium text-gray-700">URL de Vídeo (Opcional)</label>
                    <input type="text" class="activity-video mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm" placeholder="https://www.youtube.com/watch?v=...">
                </div>
                
                <div class="bg-white p-4 rounded-md border">
                    <label class="block text-base font-medium text-gray-700">Publicaciones en Redes Sociales (Opcional)</label>
                    <div class="space-y-2 mt-2">
                        <input type="text" class="social-fb mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm" placeholder="Facebook: https://www.facebook.com/...">
                        <input type="text" class="social-ig mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm" placeholder="Instagram: https://www.instagram.com/...">
                        <input type="text" class="social-tw mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm" placeholder="Twitter/X: https://x.com/...">
                    </div>
                </div>
            </div>
        </div>
    </template>


    <script type="module">
        // Estado global
        let activityCount = 0;
        let generatedData = null;
        let librariesLoaded = false;
        
        // URL de la librería DOCX que funcionó
        const DOCX_URL = "https://unpkg.com/docx@8.5.0/build/index.umd.js";
        
        /**
         * Función auxiliar para cargar un script dinámicamente
         * Devuelve una promesa que se resuelve (true) si carga, o (false) si falla.
         */
        function loadScript(src) {
            return new Promise((resolve) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = () => resolve(true);
                script.onerror = () => resolve(false);
                document.head.appendChild(script);
            });
        }

        /**
         * Inicializador de la aplicación
         */
        async function initializeApp() {
            const statusEl = document.getElementById('lib-status');
            
            // Cargar la librería DOCX
            const success = await loadScript(DOCX_URL);
            
            if (success) {
                // Comprobar si los objetos globales (docx y saveAs) existen
                // *** CORRECCIÓN 1/3: Comprobar 'saveAs' en lugar de 'FileSaver' ***
                if (typeof docx !== 'undefined' && typeof saveAs !== 'undefined') {
                    librariesLoaded = true;
                    statusEl.textContent = "¡Listo para generar!";
                    statusEl.classList.remove('text-gray-500');
                    statusEl.classList.add('text-green-600', 'font-medium');
                } else {
                    statusEl.textContent = "Error al inicializar libs.";
                    statusEl.classList.add('text-red-600', 'font-medium');
                }
            } else {
                statusEl.textContent = "Error al cargar librerías.";
                statusEl.classList.add('text-red-600', 'font-medium');
            }

            // Añadir la primera actividad al cargar
            addActivity();
        }

        /**
         * Añade un nuevo bloque de actividad al formulario
         */
        function addActivity() {
            activityCount++;
            const template = document.getElementById('activity-template');
            const clone = template.content.cloneNode(true);
            const entry = clone.querySelector('.activity-entry');
            
            // Asignar IDs únicos a los inputs (útil para 'label for')
            entry.querySelectorAll('input, textarea').forEach(input => {
                const oldId = input.id;
                if (oldId) {
                    input.id = `${oldId}-${activityCount}`;
                    const label = entry.querySelector(`label[for="${oldId}"]`);
                    if (label) {
                        label.setAttribute('for', input.id);
                    }
                }
            });

            // Añadir evento al botón de eliminar
            clone.querySelector('.delete-activity-btn').addEventListener('click', () => {
                entry.remove();
            });

            document.getElementById('activities-container').appendChild(clone);
        }

        /**
         * Lee un archivo de imagen (File) y lo convierte a Base64
         * @param {File} file - El archivo de imagen
         * @returns {Promise<Object>} - Una promesa que resuelve con { blobUrl, buffer, type, base64 }
         */
        function readImage(file) {
            return new Promise((resolve, reject) => {
                const readerForBlob = new FileReader();
                readerForBlob.onload = (e_blob) => {
                    const blobUrl = URL.createObjectURL(file); // Para HTML/PDF
                    
                    const readerForBuffer = new FileReader();
                    readerForBuffer.onload = (e_buffer) => {
                        const buffer = e_buffer.target.result; // Para DOCX
                        
                        const readerForBase64 = new FileReader();
                        readerForBase64.onload = (e_base64) => {
                             resolve({
                                blobUrl: blobUrl, // blob:http... (para <img>)
                                buffer: buffer,     // ArrayBuffer (para docx.ImageRun)
                                type: file.type,    // image/png, image/jpeg
                                base64: e_base64.target.result // data:image/png;base64,...
                            });
                        };
                        readerForBase64.readAsDataURL(file); // Para PDF (aunque blobUrl es mejor)
                    };
                    readerForBuffer.readAsArrayBuffer(file);
                };
                readerForBlob.onerror = reject;
                readerForBlob.readAsDataURL(file); // Inicia la primera lectura
            });
        }


        // --- Event Listeners ---
        
        document.getElementById('add-activity-btn').addEventListener('click', addActivity);
        const generateBtn = document.getElementById('generate-btn');
        const printBtn = document.getElementById('print-btn');
        const docxBtn = document.getElementById('docx-btn');
        const outputSection = document.getElementById('output-section');
        const documentOutput = document.getElementById('document-output');

        /**
         * Evento principal: Generar Documento
         */
        generateBtn.addEventListener('click', async () => {
            generateBtn.textContent = 'Generando...';
            generateBtn.disabled = true;

            const projectTitle = document.getElementById('project-title').value;
            
            // Usar el logo subido
            const logoFile = document.getElementById('logo-file').files[0];
            let logoImage = null;
            if (logoFile) {
                // Reutilizamos la función readImage que ya existe
                logoImage = await readImage(logoFile);
            }
            
            const activityEntries = document.querySelectorAll('#activities-container .activity-entry');
            let htmlContent = '';
            let activitiesData = [];

            // 1. Añadir Logo y Título
            if (logoImage) {
                htmlContent += `<img src="${logoImage.blobUrl}" alt="Logo" style="width: 200px; height: auto; margin: 0 auto 24px auto; display: block;">`;
            }
            if (projectTitle) {
                htmlContent += `<h1 style="text-align: center; font-size: 1.875rem; font-weight: bold; margin-bottom: 2rem;">${projectTitle}</h1>`;
            }

            // 2. Procesar cada actividad
            for (const [index, entry] of Array.from(activityEntries).entries()) {
                const name = entry.querySelector('.activity-name').value;
                const date = entry.querySelector('.activity-date').value;
                const videoUrl = entry.querySelector('.activity-video').value;
                const fb = entry.querySelector('.social-fb').value;
                const ig = entry.querySelector('.social-ig').value;
                const tw = entry.querySelector('.social-tw').value;
                
                // --- Procesamiento de Imágenes ---
                let images = [];
                
                // a) Imágenes subidas desde el ordenador
                const imageFiles = entry.querySelector('.activity-image').files;
                if (imageFiles.length > 0) {
                    for (const file of imageFiles) {
                        const imgData = await readImage(file);
                        images.push({ 
                            url: imgData.blobUrl, // Para HTML/PDF
                            buffer: imgData.buffer, // Para DOCX
                            isLocal: true
                        });
                    }
                }
                
                // b) Imágenes desde URLs
                const imageUrls = entry.querySelector('.activity-image-urls').value
                                    .split('\n')
                                    .map(url => url.trim())
                                    .filter(url => url.startsWith('http'));
                                    
                for (const url of imageUrls) {
                    images.push({
                        url: url, // Para HTML/PDF
                        buffer: null, // No podemos obtener buffer por CORS
                        isLocal: false
                    });
                }
                
                // Guardar datos para DOCX
                activitiesData.push({ name, date, videoUrl, fb, ig, tw, images });

                // --- Generar HTML para la vista previa ---
                htmlContent += `<div class="activity-output-entry" style="margin-bottom: 2.5rem; break-inside: avoid;">`;
                
                // Sección 1: Título y Fecha
                htmlContent += `<div>`;
                if (name) {
                    htmlContent += `<h2 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem;">${index + 1}. ${name}</h2>`;
                }
                if (date) {
                    const formattedDate = new Date(date).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });
                    htmlContent += `<p style="font-size: 1.125rem; color: #4B5563; margin-bottom: 1rem;">${formattedDate}</p>`;
                }
                htmlContent += `</div>`;
                
                htmlContent += `<hr style="margin-top: 1rem; margin-bottom: 1rem;">`;

                // Sección 2: Galería de Imágenes
                if (images.length > 0) {
                    htmlContent += `<div class="image-gallery" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">`;
                    for (const img of images) {
                        htmlContent += `<img src="${img.url}" style="width: 100%; height: auto; object-fit: cover; border-radius: 8px; border: 1px solid #E5E7EB;">`;
                    }
                    htmlContent += `</div>`;
                }
                
                htmlContent += `<hr style="margin-top: 1rem; margin-bottom: 1rem;">`;
                
                // Sección 3: Vídeo y Redes
                // (Eliminados los DIVs contenedores grises)
                if (videoUrl) {
                    htmlContent += `<p style="margin-bottom: 0.5rem;"><strong>Vídeo:</strong> <a href="${videoUrl}" target="_blank" style="color: #3B82F6;">${videoUrl}</a></p>`;
                }
                if (fb) {
                    htmlContent += `<p style="margin-bottom: 0.5rem;"><strong>Facebook:</strong> <a href="${fb}" target="_blank" style="color: #3B82F6;">${fb}</a></p>`;
                }
                if (ig) {
                    htmlContent += `<p style="margin-bottom: 0.5rem;"><strong>Instagram:</strong> <a href="${ig}" target="_blank" style="color: #3B82F6;">${ig}</a></p>`;
                }
                if (tw) {
                    htmlContent += `<p style="margin-bottom: 0.5rem;"><strong>Twitter/X:</strong> <a href="${tw}" target="_blank" style="color: #3B82F6;">${tw}</a></p>`;
                }
                
                htmlContent += `</div>`; // Cierre de .activity-output-entry
            }

            // Guardar datos globales
            generatedData = { projectTitle, logoImage, activities: activitiesData };

            // Mostrar vista previa
            documentOutput.innerHTML = htmlContent;
            outputSection.classList.remove('hidden');
            
            // Activar botones
            generateBtn.textContent = 'Volver a Generar';
            generateBtn.disabled = false;
            printBtn.classList.remove('hidden');
            
            // Activar DOCX solo si las librerías cargaron
            if (librariesLoaded) {
                // Esperar un breve momento para que el DOM se actualice
                setTimeout(() => {
                    // *** CORRECCIÓN 2/3: Comprobar 'saveAs' en lugar de 'FileSaver' ***
                     if (typeof docx !== 'undefined' && typeof saveAs !== 'undefined') {
                        docxBtn.disabled = false;
                        docxBtn.classList.remove('hidden');
                     } else {
                        console.error("docx o FileSaver no están definidos, aunque librariesLoaded era true.");
                        librariesLoaded = false;
                        document.getElementById('lib-status').textContent = "Error al inicializar.";
                        document.getElementById('lib-status').classList.add('text-red-600');
                     }
                }, 500); // Aumentado a 500ms por si acaso
            }
        });

        /**
         * Evento: Imprimir (Guardar como PDF)
         */
        printBtn.addEventListener('click', () => {
            window.print();
        });


        /**
         * Evento: Generar DOCX
         */
        docxBtn.addEventListener('click', async () => {
            if (!generatedData || !librariesLoaded) {
                alert("Error: No hay datos generados o las librerías no cargaron.");
                return;
            }
            
            docxBtn.textContent = 'Generando .docx...';
            docxBtn.disabled = true;

            // Desestructurar los objetos de la librería docx
            const { Document, Packer, Paragraph, TextRun, ImageRun, HeadingLevel, AlignmentType, ExternalHyperlink, PageBreak } = docx;

            let docChildren = []; // Array de párrafos e imágenes para el documento
            const { projectTitle, logoImage, activities } = generatedData;

            try {
                // 1. Añadir Logo (si existe)
                if (logoImage && logoImage.buffer) {
                     docChildren.push(
                        new Paragraph({
                            children: [
                                new ImageRun({
                                    data: logoImage.buffer,
                                    transformation: { width: 200, height: 75 }, // Ajusta tamaño según necesidad
                                })
                            ],
                            alignment: AlignmentType.CENTER,
                            spacing: { after: 200 },
                        })
                    );
                }

                // 2. Añadir Título del Proyecto
                if (projectTitle) {
                    docChildren.push(
                        new Paragraph({
                            text: projectTitle,
                            heading: HeadingLevel.HEADING_1,
                            alignment: AlignmentType.CENTER,
                            spacing: { after: 400 },
                        })
                    );
                }

                // 3. Iterar sobre las actividades
                for (const [index, activity] of activities.entries()) {
                    
                    // Añadir salto de página antes de cada actividad (excepto la primera)
                    if (index > 0) {
                        docChildren.push(new Paragraph({ children: [new PageBreak()] }));
                    }

                    // Sección 1: Título y Fecha
                    if (activity.name) {
                        docChildren.push(
                            new Paragraph({
                                text: `${index + 1}. ${activity.name}`,
                                heading: HeadingLevel.HEADING_2,
                                spacing: { after: 100 },
                            })
                        );
                    }
                    if (activity.date) {
                         const formattedDate = new Date(activity.date).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });
                         docChildren.push(
                            new Paragraph({
                                text: formattedDate,
                                style: "IntenseQuote", // Un estilo simple para diferenciarlo
                                spacing: { after: 200 },
                            })
                        );
                    }
                    
                    docChildren.push(new Paragraph({ text: "____________________", alignment: AlignmentType.CENTER, spacing: { after: 200, before: 200 } }));

                    // Sección 2: Imágenes (SOLO LOCALES)
                    for (const img of activity.images) {
                        // Solo procesamos imágenes locales (subidas) que tienen 'buffer'
                        if (img.isLocal && img.buffer) {
                             docChildren.push(
                                new Paragraph({
                                    children: [
                                        new ImageRun({
                                            data: img.buffer, // El ArrayBuffer
                                            transformation: {
                                                width: 450, 
                                                height: 300, 
                                            },
                                        }),
                                    ],
                                    spacing: { after: 100 },
                                    alignment: AlignmentType.CENTER
                                })
                            );
                        }
                    }
                    
                    docChildren.push(new Paragraph({ text: "____________________", alignment: AlignmentType.CENTER, spacing: { after: 200, before: 200 } }));


                    // Función auxiliar para crear un párrafo de enlace
                    const createLinkParagraph = (text, url) => {
                        return new Paragraph({
                            children: [
                                new TextRun({ text: `${text}: `, bold: true }),
                                new ExternalHyperlink({
                                    // *** CORRECCIÓN ***
                                    // El error estaba aquí. Debe ser 'children' (plural y un array)
                                    // en lugar de 'child' (singular).
                                    children: [
                                        new TextRun({
                                            text: url,
                                            style: "Hyperlink",
                                        })
                                    ],
                                    link: url,
                                }),
                            ],
                            spacing: { after: 100 }
                        });
                    };

                    // Sección 3: Vídeo y Redes (con enlaces clickables)
                    if (activity.videoUrl) {
                        docChildren.push(createLinkParagraph("Vídeo", activity.videoUrl));
                    }
                    if (activity.fb) {
                        docChildren.push(createLinkParagraph("Facebook", activity.fb));
                    }
                    if (activity.ig) {
                        docChildren.push(createLinkParagraph("Instagram", activity.ig));
                    }
                    if (activity.tw) {
                        docChildren.push(createLinkParagraph("Twitter/X", activity.tw));
                    }
                } // Fin del bucle de actividades

                // 4. Crear el documento
                const doc = new Document({
                    sections: [{
                        properties: {},
                        children: docChildren,
                    }],
                });

                // 5. Generar el Blob y descargarlo
                // *** CORRECCIÓN 3/3: Llamar a 'saveAs' directamente ***
                const blob = await Packer.toBlob(doc);
                saveAs(blob, "informe_generado.docx");

                docxBtn.textContent = 'Descargar .docx';
                docxBtn.disabled = false;

            } catch (error) {
                console.error("Error al generar el DOCX:", error);
                alert("Hubo un error al generar el archivo .docx: " + error.message);
                docxBtn.textContent = 'Error (Reintentar)';
                docxBtn.disabled = false;
            }
        });

        // Inicializar la aplicación al cargar la página
        initializeApp();

    </script>

</body>
</html>
